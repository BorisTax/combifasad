import{c as e,u as C,a as p,G as g4,H as m4,R as u4,r as A,W as p4,j as E,J as W,C as N,K,P as q,e as o4,L as f4,N as E4,i as a4,O as Z,Q as v4,U as C4,V as x4,X as F4,Y as y4,Z as A4,_ as b4,$ as D4,a0 as w4,a1 as I4,a2 as T4,a3 as B4,a4 as s4,a5 as W4,a6 as k4,F as J,a7 as P4,a8 as H4,a9 as P,aa as r4,ab as c4,ac as S4,ad as N4,ae as R4,af as M4,ag as $4,ah as z4,ai as L4,aj as V4,ak as _4,al as O4,am as e4,an as G4,ao as U4,ap as j4,aq as Y4,b as X4,ar as K4,as as q4,at as J4,au as Q4,av as Z4}from"./index.f6fae9fb.js";import{P as l4}from"./PropertyGrid.f75fcd90.js";function Q(u){return e("div",{className:"property-row",children:u.children})}const uu=[2,3,4,5,6];function eu(){const u=C(o4),t=C(f4),n=C(E4),i=C(a4),{profile:g,fasadCount:r,type:d,wardHeight:a,wardWidth:f}=C(Z),v=p(v4),s=p(C4),x=p(x4),k=p(F4),B=p(y4),F=g4(),D=m4(),S=p(A4),R=p(b4),y=p(D4),{next:_,previous:M}=C(w4),w=p(I4),$=p(T4),I=u.permissions.get(u4.COMBIFASADES),z=!(I!=null&&I.Create),L=!(I!=null&&I.Read),j=A.exports.useMemo(()=>[...t.keys()].filter(c=>c!==p4.GARDEROB),[t]),O=async()=>(await D("\u0422\u0435\u043A\u0443\u0449\u0430\u044F \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F \u0444\u0430\u0441\u0430\u0434\u043E\u0432 \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u0430 \u043F\u0440\u0438 \u0434\u0430\u043D\u043D\u043E\u043C \u0442\u0438\u043F\u0435 \u0448\u043A\u0430\u0444\u0430"),!1),G=async()=>(await D("\u0422\u0435\u043A\u0443\u0449\u0430\u044F \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F \u0444\u0430\u0441\u0430\u0434\u043E\u0432 \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u0430 \u043F\u0440\u0438 \u0434\u0430\u043D\u043D\u043E\u0439 \u0432\u044B\u0441\u043E\u0442\u0435"),!1),o=async()=>(await D("\u0422\u0435\u043A\u0443\u0449\u0430\u044F \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F \u0444\u0430\u0441\u0430\u0434\u043E\u0432 \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u0430 \u043F\u0440\u0438 \u0434\u0430\u043D\u043D\u043E\u0439 \u0448\u0438\u0440\u0438\u043D\u0435"),!1),h=async()=>(await D("\u0422\u0435\u043A\u0443\u0449\u0430\u044F \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F \u0444\u0430\u0441\u0430\u0434\u043E\u0432 \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u0430 \u043F\u0440\u0438 \u0434\u0430\u043D\u043D\u043E\u043C \u0442\u0438\u043F\u0435 \u043F\u0440\u043E\u0444\u0438\u043B\u044F"),!1),l=async()=>(await D("\u0422\u0435\u043A\u0443\u0449\u0430\u044F \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F \u0444\u0430\u0441\u0430\u0434\u043E\u0432 \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u0430 \u043F\u0440\u0438 \u0434\u0430\u043D\u043D\u043E\u043C \u043A\u043E\u043B-\u0432\u0435 \u0444\u0430\u0441\u0430\u0434\u043E\u0432"),!1);return E("div",{className:"properties-bar",children:[E("div",{className:"d-flex flex-nowrap justify-content-between",children:[e("div",{children:"\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B \u0448\u043A\u0430\u0444\u0430"}),E("div",{className:"d-flex flex-nowrap  align-self-center gap-2 h-100",children:[e(W,{title:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438 \u043F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E",icon:"new",onClick:async()=>{await F("\u0421\u0431\u0440\u043E\u0441\u0438\u0442\u044C \u0432 \u043D\u0430\u0447\u0430\u043B\u044C\u043D\u043E\u0435 \u0441\u043E\u0441\u0442\u043E\u044F\u043D\u0438\u0435?")&&S()}}),e(W,{title:"\u041E\u0442\u043A\u0440\u044B\u0442\u044C",icon:"open",disabled:L,onClick:()=>{y()}}),e(W,{title:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",icon:"save",disabled:z,onClick:()=>{R()}}),e(W,{title:"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C",icon:"undo",disabled:!M,onClick:()=>{w()}}),e(W,{title:"\u041F\u043E\u0432\u0442\u043E\u0440\u0438\u0442\u044C",icon:"redo",disabled:!_,onClick:()=>{$()}})]})]}),e("hr",{}),E(l4,{children:[e(N,{title:"\u0422\u0438\u043F:",value:d,items:j,displayValue:c=>t.get(c)||"",onChange:(c,b)=>{B([b,O])}}),e("div",{className:"text-end",children:"\u0428\u0438\u0440\u0438\u043D\u0430: "}),e(Q,{children:e(K,{name:"width",value:f,type:q.INTEGER_POSITIVE_NUMBER,min:900,max:4e3,setValue:c=>{x([+c,o])},submitOnLostFocus:!0})}),e("div",{className:"text-end",children:"\u0412\u044B\u0441\u043E\u0442\u0430: "}),e(Q,{children:e(K,{name:"height",value:a,type:q.INTEGER_POSITIVE_NUMBER,min:1800,max:2700,setValue:c=>{k([+c,G])},submitOnLostFocus:!0})}),e(N,{title:"\u041A\u043E\u043B-\u0432\u043E \u0444\u0430\u0441\u0430\u0434\u043E\u0432:",value:r,items:uu,displayValue:c=>`${c}`,onChange:(c,b)=>{s([+b,l])}}),e(N,{title:"\u041F\u0440\u043E\u0444\u0438\u043B\u044C:",value:g.id,items:[...n.keys()],displayValue:c=>{var b,H;return((H=i.get(((b=n.get(c))==null?void 0:b.charId)||0))==null?void 0:H.name)||""},onChange:(c,b)=>{v([b,h])}})]})]})}function n4({title:u,onClick:t,iconPressed:n,iconUnPressed:i,pressed:g,disabled:r=!1,visible:d=!0}){let a=r?"button-disabled":"button";a+=g?" button-down":" button-up";const{onMouseOver:f,onMouseLeave:v}=B4(u);return e("div",{style:{visibility:d?"visible":"hidden"},className:`${a} ${g?n:i} noselect`,onClick:s=>{r||(s.stopPropagation(),t())},onMouseOver:s=>{f(s,{disabled:r})},onMouseLeave:()=>{v()},onContextMenu:s=>{s.preventDefault()}})}const tu=[1,2,3,4,5,6,7,8,9,10],X=new Map;function iu(){const{permissions:u}=C(o4),t=u.get(u4.SPECIFICATION),n=u.get(u4.TEMPLATE),i=C(r4);C(Z);const g=i==null?void 0:i.parent;C(c4);const r=C(S4),d=C(N4),a=C(a4),{width:f,height:v,materialId:s,fasadType:x,direction:k,directions:B,sectionCount:F,fixHeight:D,fixWidth:S,disabledWidth:R,disabledHeight:y,disabledFixHeight:_,disabledFixWidth:M}=su(i),w=A.exports.useMemo(()=>{const m=d.filter(U=>U.id===x);return(x===s4.DSP||x===s4.LACOBEL?m.toSorted((U,h4)=>{var t4,i4;return(((t4=a.get(U.charId))==null?void 0:t4.name)||"")>(((i4=a.get(h4.charId))==null?void 0:i4.name)||"")?1:-1}):m).map(U=>U.charId)},[d,x]),$=i?tu:[],I=p(R4),z=p(M4),L=p($4),j=p(z4),O=p(L4),G=p(V4),o=p(_4),h=p(O4),l=p(e4),c=C(G4),b=p(U4),H=p(j4),V=W4(g),Y=k4(g);return E("div",{className:"properties-bar",onClick:m=>{m.stopPropagation()},children:[E("div",{className:"property-bar-header",children:["\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B \u0444\u0430\u0441\u0430\u0434\u0430",E("div",{className:"d-flex gap-1",children:[(t==null?void 0:t.Read)&&e(J,{children:e(W,{title:"C\u043F\u0435\u0446\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u044F",icon:"specButton",onClick:()=>{H()}})}),(n==null?void 0:n.Create)&&e(W,{title:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u043A\u0430\u043A \u0448\u0430\u0431\u043B\u043E\u043D",icon:"save",visible:i!==null,onClick:()=>{b(!0)}}),(n==null?void 0:n.Read)&&e(W,{title:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0438\u0437 \u0448\u0430\u0431\u043B\u043E\u043D\u0430",icon:"open",visible:i!==null,onClick:()=>{b(!1)}}),i&&e(W,{title:"\u0421\u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0444\u0430\u0441\u0430\u0434",icon:"copy",onClick:()=>{var m;(m=c==null?void 0:c.current)==null||m.showModal()}}),e(W,{title:"\u041F\u0435\u0440\u0435\u0439\u0442\u0438 \u043D\u0430 \u0443\u0440\u043E\u0432\u0435\u043D\u044C \u0432\u0432\u0435\u0440\u0445",icon:"selectParent",onClick:()=>{l(g)},disabled:i===null||(i==null?void 0:i.level)===0})]})]}),e("hr",{}),E(l4,{children:[e("div",{className:"text-end",children:"\u0412\u044B\u0441\u043E\u0442\u0430: "}),E(Q,{children:[e(K,{value:v,type:q.INTEGER_POSITIVE_NUMBER,min:1,setValue:m=>{I(+m)},disabled:y}),Y>0&&!D&&e("span",{children:`${i==null?void 0:i.heightRatio}/${Y}`}),e(n4,{pressed:D,iconPressed:"fix",iconUnPressed:"unfix",title:"\u0417\u0430\u0444\u0438\u043A\u0441\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0432\u044B\u0441\u043E\u0442\u0443",visible:!_,onClick:()=>{j(!D)}})]}),e("div",{className:"text-end",children:"\u0428\u0438\u0440\u0438\u043D\u0430: "}),E(Q,{children:[e(K,{value:f,type:q.INTEGER_POSITIVE_NUMBER,min:1,setValue:m=>{z(+m)},disabled:R}),V>0&&!S&&e("span",{children:`${i==null?void 0:i.widthRatio}/${V}`}),e(n4,{pressed:S,iconPressed:"fix",iconUnPressed:"unfix",title:"\u0417\u0430\u0444\u0438\u043A\u0441\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0448\u0438\u0440\u0438\u043D\u0443",visible:!M,onClick:()=>{L(!S)}})]}),e(N,{title:"\u0422\u0438\u043F:",value:x,items:[...r.keys()],displayValue:m=>r.get(m),disabled:!i,onChange:(m,T)=>{O(T)}}),e(N,{title:"\u0426\u0432\u0435\u0442/\u0420\u0438\u0441\u0443\u043D\u043E\u043A:",value:s,items:w,displayValue:m=>{var T;return(T=a.get(m))==null?void 0:T.name},disabled:!i,onChange:(m,T)=>{G(T)}}),e(N,{title:"\u041D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u043F\u0440\u043E\u0444\u0438\u043B\u044F:",value:k,items:[...B.keys()],displayValue:m=>B.get(m),disabled:!i,onChange:(m,T)=>{o(T)}}),e(N,{title:"\u041A\u043E\u043B-\u0432\u043E \u0441\u0435\u043A\u0446\u0438\u0439:",value:F,items:$,displayValue:m=>`${m}`,disabled:!i,onChange:(m,T)=>{h(T)}})]})]})}function su(u,t){const n=P4(u),i=H4(u),g=(u==null?void 0:u.materialId)||0,r=(u==null?void 0:u.fasadType)||0;X.clear(),u&&(X.set(P.WIDTH,"\u0412\u0435\u0440\u0442\u0438\u043A\u0430\u043B\u044C\u043D\u043E"),X.set(P.HEIGHT,"\u0413\u043E\u0440\u0438\u0437\u043E\u043D\u0442\u0430\u043B\u044C\u043D\u043E"));const d=u==null?void 0:u.division,a=u&&u.children.length>1?u.children.length:1,f=(u==null?void 0:u.fixedWidth)||!1,v=(u==null?void 0:u.fixedHeight)||!1,s=u==null?void 0:u.parent;let x=!u||u.level===0||u.level===1&&(s==null?void 0:s.division)===P.HEIGHT||u.fixedWidth,k=!u||u.level===0||u.level===1&&(s==null?void 0:s.division)===P.WIDTH||u.fixedHeight;const B=!u||u.level===0||u.level===1&&(s==null?void 0:s.division)===P.HEIGHT,F=!u||u.level===0||u.level===1&&(s==null?void 0:s.division)===P.WIDTH;return x=x||!!(u&&u.level<=1&&(s==null?void 0:s.division)===P.HEIGHT),k=k||!!(u&&u.level<=1&&(s==null?void 0:s.division)===P.WIDTH),{width:n,height:i,materialId:g,fasadType:r,direction:d,directions:X,sectionCount:a,fixHeight:v,fixWidth:f,disabledWidth:x,disabledHeight:k,disabledFixHeight:F,disabledFixWidth:B}}function nu(){return e("div",{className:"fixedHeight"})}function ou(){return e("div",{className:"fixedWidth"})}function au(){return e("div",{className:"fixedBoth"})}function d4(u){const t=u.fasad,n=Y4(t),i=t.children.length===0,g=u.activeFasad,r=t.backImageProps;n||(r.top=0,r.left=0,r.size="");const[{top:d,left:a,size:f,repeat:v,drag:s,x0:x,y0:k,hasImage:B},F]=A.exports.useState({hasImage:!1,...r,drag:!1,x0:0,y0:0});A.exports.useMemo(()=>{F(o=>({...o,...r}))},[t,r.top,r.left,r.size,r.repeat]);const{showFixIcons:D}=C(c4),S=p(e4),R=X4(t.materialId),y=A.exports.useRef(null),_=A.exports.useRef(null);let M={gridTemplateRows:"1fr",gridTemplateColumns:"1fr"};if(!i){const o=t.division===P.HEIGHT,h=o?t.height:t.width,l=t.children.map(c=>`${(o?(c.height+1)/h:(c.width+1)/h).toFixed(3)}fr`).join(" ");M=o?{gridTemplateRows:l,gridTemplateColumns:"1fr"}:{gridTemplateRows:"1fr",gridTemplateColumns:l}}let w=t.level===0?{height:"100%"}:{};w={...w,boxShadow:t===g?"inset 0px 0px 10px red":""};let $={},I="";i?(w={...w,display:"flex",overflow:"hidden",flexShrink:"0",justifyContent:"center",alignItems:"center",objectFit:"cover",cursor:"pointer",border:"1px solid black",backgroundPosition:`top ${d}px left ${a}px`,backgroundSize:typeof f=="number"?`${f}%`:f,backgroundRepeat:v?"repeat":"no-repeat"},$={onClick:o=>{o.stopPropagation(),S(t)},onMouseDown:o=>{if(!!n){if(o.button===1){const h=K4();F(l=>({...l,...h})),t.backImageProps={...h};return}o.button===0&&(!o.shiftKey||!B||F(h=>({...h,drag:!0,x0:o.clientX,y0:o.clientY})))}},onMouseMove:o=>{if(o.button!==0||!s)return;const h=o.clientX-x,l=o.clientY-k;F(c=>({...c,top:c.top+l,left:c.left+h,x0:o.clientX,y0:o.clientY}))},onMouseUp:o=>{if(!!n){if(o.button!==0)return!0;F(h=>({...h,drag:!1})),t.backImageProps={top:d,left:a,size:f,repeat:v}}},onMouseLeave:()=>{!n||(F(o=>({...o,drag:!1})),t.backImageProps={top:d,left:a,size:f,repeat:v})}},I="fasad-section"):w={...w,border:t===g?"1px solid red":"",backgroundColor:"white",backgroundImage:""};const z=t.children.length===0&&t.fixedHeight&&D,L=t.children.length===0&&t.fixedWidth&&D,O=z&&L?e(au,{}):z?e(nu,{}):L?e(ou,{}):e(J,{}),G=t.children.length>1?t.children.map((o,h)=>e(d4,{fasad:o,activeFasad:u.activeFasad,rootFasad:u.rootFasad},h)):"";return A.exports.useEffect(()=>{const o=new Image,h=R;o.src=h,y.current&&(y.current.style.backgroundImage=h||getComputedStyle(y.current).getPropertyValue("--default-image"),y.current.style.backgroundPosition="top 0px left 0px",y.current.style.backgroundSize="",F(l=>({...l,hasImage:!1}))),y.current&&i&&h&&(y.current.style.backgroundImage=`url(${h})`,ru(y.current,{top:d,left:a,size:f,repeat:v}),F(l=>({...l,hasImage:!0})))},[R,i]),A.exports.useEffect(()=>{var h;if(!n)return;const o=l=>{if(l.preventDefault(),!B)return;const c=l.clientX-l.target.offsetLeft-a,b=l.clientY-l.target.offsetTop-d,H=Math.sign(l.deltaY)>=0?l.shiftKey?.99:.9:l.shiftKey?1.01:1.1;F(V=>{const Y=typeof V.size=="string"?100:V.size;return{...V,size:Y*H,top:d+b*(1-H),left:a+c*(1-H)}}),t.backImageProps={top:d,left:a,size:f,repeat:v}};return(h=y.current)==null||h.addEventListener("wheel",o,{passive:!1}),()=>{var l;(l=y.current)==null||l.removeEventListener("wheel",o)}},[B,a,d,n]),E("div",{ref:i?y:_,className:I,style:{display:"grid",...M,gap:"1px",...w},...$,children:[G,O]})}function ru(u,t){u.style.backgroundPosition=`top ${t.top}px left ${t.left}px`,u.style.backgroundSize=typeof t.size=="number"?`${t.size}%`:t.size,u.style.backgroundRepeat=t.repeat?"repeat":"no-repeat"}function cu({index:u}){const{rootFasades:t}=C(Z),n=C(q4),i=window.innerWidth,g=t[u],r=g.width/g.height;`${g.width}${g.height}`;const d=C(r4),a=A.exports.useRef(null),f=n===u?"fw-bold":"",v=s=>{a.current&&(a.current.style.width=a.current.offsetHeight*s+"px")};return A.exports.useLayoutEffect(()=>{v(r)},[r,i]),E("div",{className:"fasad-container",children:[e("div",{className:`text-center ${f}`,children:`\u0424\u0430\u0441\u0430\u0434 ${u+1}`}),e("div",{ref:a,className:"fasad-section-container",style:{height:"100%",width:"auto"},children:e(d4,{fasad:g,activeFasad:d,rootFasad:g})})]})}function lu(){const[,u]=A.exports.useState(0),[{rootFasades:t}]=J4(Z),n=t[0].width/t[0].height,i=A.exports.useRef(null),g=t.map((d,a)=>e(cu,{index:a},a)),r=window.innerWidth;return A.exports.useEffect(()=>{const d=()=>u(Math.random());return window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d)}},[]),A.exports.useLayoutEffect(()=>{du(n,t,i)},[r,n,t]),e("div",{ref:i,className:"rootfasades-container",children:g})}const du=(u,t,n)=>{if(!n.current)return;const i=document.querySelector(".properties-container"),g=document.querySelector(".combifasades-container"),r=Q4(),d=parseFloat(getComputedStyle(n.current).gap);if(r){const a=i.offsetHeight,f=g.offsetWidth-i.offsetWidth,v=a*u,s=Math.min(Math.floor(f/(v+d)),t.length),x=v*s;n.current.style.height=`${a}px`,n.current.style.width=`${x}px`,n.current.style.overflowX=s<t.length?"scroll":"unset"}else{const a=Math.ceil(t.length/2),f=parseFloat(getComputedStyle(i).width),s=f/a/u;n.current.style.width=`${f}px`,n.current.style.height=`${s}px`,n.current.style.overflowX=a<t.length?"scroll":"unset"}};function hu(){return E("div",{className:"status-bar",children:[E("span",{children:[e("code",{children:"Shift + \u041B\u0435\u0432\u0430\u044F \u043A\u043D\u043E\u043F\u043A\u0430 \u043C\u044B\u0448\u0438"})," - \u0434\u0432\u0438\u0433\u0430\u0442\u044C \u043A\u0430\u0440\u0442\u0438\u043D\u043A\u0443 \u0444\u0430\u0441\u0430\u0434\u0430"]}),E("span",{children:[e("code",{children:"\u041A\u043E\u043B\u0435\u0441\u0438\u043A\u043E \u043C\u044B\u0448\u0438"})," - \u043C\u0430\u0441\u0448\u0442\u0430\u0431 +/-"]}),E("span",{children:[e("code",{children:"\u041A\u043E\u043B\u0435\u0441\u0438\u043A\u043E \u043C\u044B\u0448\u0438 + Shift"})," - \u043F\u043B\u0430\u0432\u043D\u044B\u0439 \u043C\u0430\u0441\u0448\u0442\u0430\u0431"]}),E("span",{children:[e("code",{children:"\u0421\u0440\u0435\u0434\u043D\u044F\u044F \u043A\u043D\u043E\u043F\u043A\u0430 \u043C\u044B\u0448\u0438"})," - \u0441\u0431\u0440\u043E\u0441 \u043C\u0430\u0441\u0448\u0442\u0430\u0431\u0430"]})]})}function pu(){const u=p(e4);return e(J,{children:E("div",{className:"main-container",children:[Z4()?e(J,{}):e(hu,{}),E("div",{className:"combifasades-container",onClick:()=>{u()},children:[E("div",{className:"properties-container",children:[e(eu,{}),e(iu,{})]}),e(lu,{})]})]})})}export{pu as default};
