import{u as I,R as W,a as C,r as h,b as Et,m as A,I as T,j as L,E as V,c as m,T as F,d as z,e as S,f as lt,g as pt,h as mt,i as et,k as gt,C as st,l as Tt,n as ht,s as at,o as nt,p as x,q as ut,A as U,M as K,D as Y,t as It,v as P,S as yt,w as Rt,x as At,W as H,y as J,P as B,z as ot,B as Dt,F as Q,G as St,H as ft}from"./index.bae239ca.js";import Ct from"./EditSpecificationDialog.dc088901.js";function _t(){var t,O,M,w;const{permissions:d}=I(S),s=d.get(W.MATERIALS_DB),o=C(lt),c=C(pt),n=C(mt),E=I(et),p=I(gt),y=h.exports.useMemo(()=>[...E.keys()][0]||0,[E]),[l,b]=h.exports.useState(y),D=Et(l),R=["\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435","\u041A\u043E\u0434","\u0422\u0438\u043F"],$=[];E.forEach((u,e)=>$.push({key:e,data:[u.name,u.code,p.get(u.char_type_id)]}));const N=[{caption:"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435:",value:((t=E.get(l))==null?void 0:t.name)||"",message:A.ENTER_CAPTION,type:T.TEXT},{caption:"\u041A\u043E\u0434:",value:((O=E.get(l))==null?void 0:O.code)||"",message:A.ENTER_CODE,type:T.TEXT},{caption:"\u0422\u0438\u043F:",value:((M=E.get(l))==null?void 0:M.char_type_id)||0,valueCaption:u=>p.get(u)||"",list:[...p.keys()],message:"",type:T.LIST},{caption:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435:",value:D||"",message:A.ENTER_IMAGE,type:T.FILE}];return L(V,{children:[m("div",{children:m(F,{heads:R,content:$,onSelectKey:u=>{b(u)}})}),s!=null&&s.Read?m(z,{name:(w=E.get(l))==null?void 0:w.name,items:N,onUpdate:s!=null&&s.Update?async(u,e)=>{const i=u[0]?e[0]:"",a=u[1]?e[1]:"",r=u[2]?e[2]:0,g=u[3]?e[3]:"";return await o({id:l,char_type_id:r,name:i,code:a,image:g})}:void 0,onDelete:s!=null&&s.Delete?async()=>{const u=await n(l);return b([...E.keys()][0]||0),u}:void 0,onAdd:s!=null&&s.Create?async(u,e)=>{const i=u[0]?e[0]:"",a=u[1]?e[1]:"",r=u[2]?e[2]:0,g=u[3]?e[3]:"";return await c({name:i,char_type_id:r,code:a,image:g})}:void 0}):m("div",{})]})}function xt(){var e,i;const{permissions:d}=I(S),s=C(Tt),o=C(ht),c=d.get(W.MATERIALS_DB),n=I(at),E=I(et),p=I(nt),y=h.exports.useMemo(()=>[...n.keys()][0]||0,[n]),[l,b]=h.exports.useState(y),D=h.exports.useMemo(()=>p.filter(a=>a.id===l),[p,l]),R=h.exports.useMemo(()=>D.filter(a=>a.id===l).map(a=>a.charId),[D,l]),$=[...E.keys()].filter(a=>{var r,g;return((r=E.get(a))==null?void 0:r.char_type_id)===((g=n.get(l))==null?void 0:g.charType)}),N=h.exports.useMemo(()=>R[0]||0,[R]),[t,O]=h.exports.useState(N),M=["\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435","\u041A\u043E\u0434"],w=[];R.forEach(a=>{var r,g;return w.push({key:a,data:[(r=E.get(a))==null?void 0:r.name,(g=E.get(a))==null?void 0:g.code]})});const u=[{caption:"\u0425\u0430\u0440\u0430\u043A\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043A\u0430:",value:t,valueCaption:a=>{var r;return((r=E.get(a))==null?void 0:r.name)||""},list:$,message:A.ENTER_CAPTION,type:T.LIST}];return h.exports.useEffect(()=>{O(R[0]||0)},[R]),L(V,{children:[L("div",{children:[m("div",{className:"d-flex flex-nowrap gap-2 align-items-start",children:m(st,{title:"\u041D\u043E\u043C\u0435\u043D\u043A\u043B\u0430\u0442\u0443\u0440\u0430: ",value:l,items:[...n.keys()],displayValue:a=>{var r;return((r=n.get(a))==null?void 0:r.name)||""},onChange:a=>{b(a)}})}),m("hr",{}),w.length>0&&m(F,{heads:M,content:w,onSelectKey:a=>{O(a)}})]}),(c==null?void 0:c.Read)&&w.length>0?m(z,{name:((e=n.get(l))==null?void 0:e.name)+""+((i=E.get(t))==null?void 0:i.name),items:u,onDelete:c!=null&&c.Delete?async()=>{const a=await o({id:l,charId:t});return O(R[0]||0),a}:void 0,onAdd:c!=null&&c.Create?async(a,r)=>{const g=r[0];return D.find(_=>_.charId===g)?{success:!1,message:A.MATERIAL_EXIST}:await s({id:l,charId:g})}:void 0}):m("div",{})]})}const ct=x(new Map),Z=x(null,async(d,s)=>{var n;const{token:o,permissions:c}=d(S);if(!((n=c.get(W.MATERIALS))!=null&&n.Read))return{success:!1,message:""};try{const E=await ut(`${U}${K}${Y}?token=${o}`);E.success&&s(ct,It(E.data))}catch(E){console.error(E)}}),Nt=x(null,async(d,s,o)=>{var E;const{token:c,permissions:n}=d(S);if(!((E=n.get(W.MATERIALS))!=null&&E.Delete))return{success:!1,message:""};try{const p=await P(`${U}${K}${Y}`,"DELETE",JSON.stringify({id:o,token:c}));return await s(Z),{success:p.success,message:p.message}}catch(p){return console.error(p),{success:!1,message:A.QUERY_ERROR}}}),wt=x(null,async(d,s,o)=>{var E;const{token:c,permissions:n}=d(S);if(!((E=n.get(W.MATERIALS))!=null&&E.Create))return{success:!1,message:""};try{const p=await P(`${U}${K}${Y}`,"POST",JSON.stringify({data:o,token:c}));return await s(Z),{success:p.success,message:p.message}}catch(p){return console.error(p),{success:!1,message:A.QUERY_ERROR}}}),Ot=x(null,async(d,s,o)=>{var E;const{token:c,permissions:n}=d(S);if(!((E=n.get(W.MATERIALS))!=null&&E.Update))return{success:!1,message:""};try{const p=await P(`${U}${K}${Y}`,"PUT",JSON.stringify({data:o,token:c}));return await s(Z),{success:p.success,message:p.message}}catch(p){return console.error(p),{success:!1,message:A.QUERY_ERROR}}});function Bt(){var i;const{permissions:d}=I(S),s=C(Z),o=d.get(W.MATERIALS),c=I(ct),n=I(et),E=I(At),y=I(nt).filter(a=>a.id===yt.DSP16).map(a=>a.charId),l=E.filter(a=>a.char_type_id===Rt.COLOR).map(a=>a.id),b=()=>c.keys().next().value||0,[D,R]=h.exports.useState(b()),{kromkaId:$,zaglushkaId:N}=c.get(D)||{kromkaId:0,zaglushkaId:0},t=C(Nt),O=C(wt),M=C(Ot),w=["\u0414\u0421\u041F","\u041A\u0440\u043E\u043C\u043A\u0430","\u0417\u0430\u0433\u043B\u0443\u0448\u043A\u0430"],u=[];c.forEach((a,r)=>{var g,f,_;return u.push({key:r,data:[(g=n.get(r))==null?void 0:g.name,(f=n.get(a.kromkaId))==null?void 0:f.name,(_=n.get(a.zaglushkaId))==null?void 0:_.name]})});const e=[{caption:"\u0414\u0421\u041F:",value:D,valueCaption:a=>{var r;return((r=n.get(a))==null?void 0:r.name)||""},message:A.ENTER_CAPTION,type:T.LIST,list:y},{caption:"\u041A\u0440\u043E\u043C\u043A\u0430:",value:$,valueCaption:a=>{var r;return((r=n.get(a))==null?void 0:r.name)||""},message:A.ENTER_CODE,type:T.LIST,list:l},{caption:"\u0417\u0430\u0433\u043B\u0443\u0448\u043A\u0430:",value:N,valueCaption:a=>{var r;return((r=n.get(a))==null?void 0:r.name)||""},message:A.ENTER_CODE,type:T.LIST,list:l}];return h.exports.useEffect(()=>{s()},[o==null?void 0:o.Read]),L(V,{children:[m(F,{heads:w,content:u,onSelectKey:a=>{R(a)}}),o!=null&&o.Read?m(z,{name:(i=n.get(D))==null?void 0:i.name,items:e,onUpdate:o!=null&&o.Update?async(a,r)=>{const g=a[1]?r[1]:0,f=a[2]?r[2]:0;return await M({id:D,kromkaId:g,zaglushkaId:f})}:void 0,onAdd:o!=null&&o.Create?async(a,r)=>{const g=r[0],f=r[1],_=r[2];return await O({id:g,kromkaId:f,zaglushkaId:_})}:void 0,onDelete:o!=null&&o.Delete?async()=>{const a=await t(D);return R(b()),a}:void 0}):m("div",{})]})}const rt=x([]),j=x(null,async(d,s)=>{const{token:o}=d(S);try{const c=await ut(`${U}${H}${J}?token=${o}`);s(rt,c.data)}catch(c){console.error(c)}}),Ut=x(null,async(d,s,o)=>{const{token:c}=d(S);try{const n=await P(`${U}${H}${J}`,"POST",JSON.stringify({...o,token:c}));return s(j),{success:n.success,message:n.message}}catch(n){return console.error(n),{success:!1,message:A.QUERY_ERROR}}}),bt=x(null,async(d,s,o)=>{const{token:c}=d(S);try{const n=await P(`${U}${H}${J}`,"PUT",JSON.stringify({...o,token:c}));return s(j),{success:n.success,message:n.message}}catch(n){return console.error(n),{success:!1,message:A.QUERY_ERROR}}}),$t=x(null,async(d,s,o)=>{const{token:c}=d(S);try{const n=await P(`${U}${H}${J}`,"DELETE",JSON.stringify({id:o,token:c}));return s(j),{success:n.success,message:n.message}}catch(n){return console.error(n),{success:!1,message:A.QUERY_ERROR}}});function Mt(){const{permissions:d}=I(S),s=d.get(W.MATERIALS_DB),o=C(j),c=C(bt),n=C(Ut),E=C($t),p=I(ot),y=I(Dt),[l,b]=h.exports.useState([...p.keys()][0]),D=I(rt),R=h.exports.useMemo(()=>D.filter(u=>u.wardrobeId===l),[D,l]),[$,N]=h.exports.useState(0),t=R[$],O=["\u0414\u0435\u0442\u0430\u043B\u044C","\u0428\u0438\u0440\u0438\u043D\u0430 \u043E\u0442","\u0428\u0438\u0440\u0438\u043D\u0430 \u0434\u043E","\u0412\u044B\u0441\u043E\u0442\u0430 \u043E\u0442","\u0412\u044B\u0441\u043E\u0442\u0430 \u0434\u043E","\u041A\u043E\u043B-\u0432\u043E","\u0414\u043B\u0438\u043D\u0430","\u0428\u0438\u0440\u0438\u043D\u0430"],M=R.map((u,e)=>({key:e,data:[y.get(u.detailId)||"",u.minWidth,u.maxWidth,u.minHeight,u.maxHeight,u.count,u.length,u.width]})),w=[{caption:"\u0414\u0435\u0442\u0430\u043B\u044C:",value:(t==null?void 0:t.detailId)||0,valueCaption:u=>y.get(u)||"",message:A.ENTER_CAPTION,type:T.LIST,list:[...y.keys()],listWithEmptyRow:!0},{caption:"\u0428\u0438\u0440\u0438\u043D\u0430 \u043E\u0442:",value:(t==null?void 0:t.minWidth)||0,type:T.TEXT,propertyType:B.INTEGER_POSITIVE_NUMBER},{caption:"\u0428\u0438\u0440\u0438\u043D\u0430 \u0434\u043E:",value:(t==null?void 0:t.maxWidth)||0,type:T.TEXT,propertyType:B.INTEGER_POSITIVE_NUMBER},{caption:"\u0412\u044B\u0441\u043E\u0442\u0430 \u043E\u0442:",value:(t==null?void 0:t.minHeight)||0,type:T.TEXT,propertyType:B.INTEGER_POSITIVE_NUMBER},{caption:"\u0412\u044B\u0441\u043E\u0442\u0430 \u0434\u043E:",value:(t==null?void 0:t.maxHeight)||0,type:T.TEXT,propertyType:B.INTEGER_POSITIVE_NUMBER},{caption:"\u041A\u043E\u043B-\u0432\u043E:",value:(t==null?void 0:t.count)||0,type:T.TEXT,propertyType:B.INTEGER_POSITIVE_NUMBER},{caption:"\u0414\u043B\u0438\u043D\u0430:",value:(t==null?void 0:t.length)||"",type:T.TEXT},{caption:"\u0428\u0438\u0440\u0438\u043D\u0430:",value:(t==null?void 0:t.width)||"",type:T.TEXT}];return h.exports.useEffect(()=>{o()},[]),L(V,{children:[L("div",{children:[m(st,{value:l,displayValue:u=>p.get(u),items:[...p.keys()],onChange:u=>b(u)}),m(F,{heads:O,content:M,onSelectRow:u=>{N(u)}})]}),s!=null&&s.Read?m(z,{name:y.get(t==null?void 0:t.detailId),items:w,onUpdate:s!=null&&s.Update?async(u,e)=>{const i=u[0]?e[0]:t.detailId,a=u[1]?+e[1]:t.minWidth,r=u[2]?+e[2]:t.maxWidth,g=u[3]?+e[3]:t.minHeight,f=u[4]?+e[4]:t.maxHeight,_=u[5]?+e[5]:t.count,v=u[6]?e[6]:t.length,k=u[7]?e[7]:t.width;return await c({id:t.id,wardrobeId:t.wardrobeId,detailId:i,maxWidth:r,minWidth:a,minHeight:g,maxHeight:f,count:_,length:v,width:k})}:void 0,onDelete:s!=null&&s.Delete?async()=>{const u=await E(t.id);return N(0),u}:void 0,onAdd:s!=null&&s.Create?async(u,e)=>{const i=u[0]?e[0]:t.detailId,a=u[1]?+e[1]:t.minWidth||0,r=u[2]?+e[2]:t.maxWidth||0,g=u[3]?+e[3]:t.minHeight||0,f=u[4]?+e[4]:t.maxHeight||0,_=u[5]?+e[5]:t.count||0,v=u[6]?e[6]:t.length||"",k=u[7]?e[7]:t.width||"";return await n({wardrobeId:l,detailId:i,maxWidth:r,minWidth:a,minHeight:g,maxHeight:f,count:_,length:v,width:k})}:void 0}):m("div",{})]})}const it=x([]),q=x(null,async(d,s)=>{const{token:o}=d(S);try{const c=await ut(`${U}${H}${Q}?token=${o}`);s(it,c.data)}catch(c){console.error(c)}}),Wt=x(null,async(d,s,o)=>{const{token:c}=d(S);try{const n=await P(`${U}${H}${Q}`,"POST",JSON.stringify({...o,token:c}));return s(q),{success:n.success,message:n.message}}catch(n){return console.error(n),{success:!1,message:A.QUERY_ERROR}}}),Lt=x(null,async(d,s,o)=>{const{token:c}=d(S);try{const n=await P(`${U}${H}${Q}`,"PUT",JSON.stringify({...o,token:c}));return s(q),{success:n.success,message:n.message}}catch(n){return console.error(n),{success:!1,message:A.QUERY_ERROR}}}),Pt=x(null,async(d,s,o)=>{const{token:c}=d(S);try{const n=await P(`${U}${H}${Q}`,"DELETE",JSON.stringify({id:o,token:c}));return s(q),{success:n.success,message:n.message}}catch(n){return console.error(n),{success:!1,message:A.QUERY_ERROR}}});function vt(){var u;const{permissions:d}=I(S),s=d.get(W.MATERIALS_DB),o=C(q),c=C(Lt),n=C(Wt),E=C(Pt),p=I(ot),y=I(at),[l,b]=h.exports.useState([...p.keys()][0]),D=I(it),R=h.exports.useMemo(()=>D.filter(e=>e.wardrobeId===l),[D,l]),[$,N]=h.exports.useState(0),t=R[$],O=["\u0424\u0443\u0440\u043D\u0438\u0442\u0443\u0440\u0430","\u0428\u0438\u0440\u0438\u043D\u0430 \u043E\u0442","\u0428\u0438\u0440\u0438\u043D\u0430 \u0434\u043E","\u0413\u043B\u0443\u0431\u0438\u043D\u0430 \u043E\u0442","\u0413\u043B\u0443\u0431\u0438\u043D\u0430 \u0434\u043E","\u0412\u044B\u0441\u043E\u0442\u0430 \u043E\u0442","\u0412\u044B\u0441\u043E\u0442\u0430 \u0434\u043E","\u041A\u043E\u043B-\u0432\u043E","\u0420\u0430\u0437\u043C\u0435\u0440"],M=R.map((e,i)=>{var a;return{key:i,data:[((a=y.get(e.specId))==null?void 0:a.name)||"",e.minWidth,e.maxWidth,e.minDepth,e.maxDepth,e.minHeight,e.maxHeight,e.count,e.size]}}),w=[{caption:"\u0424\u0443\u0440\u043D\u0438\u0442\u0443\u0440\u0430:",value:(t==null?void 0:t.specId)||0,valueCaption:e=>{var i;return((i=y.get(e))==null?void 0:i.name)||""},message:A.ENTER_CAPTION,type:T.LIST,list:[...y.keys()],listWithEmptyRow:!0},{caption:"\u0428\u0438\u0440\u0438\u043D\u0430 \u043E\u0442:",value:(t==null?void 0:t.minWidth)||0,type:T.TEXT,propertyType:B.INTEGER_POSITIVE_NUMBER},{caption:"\u0428\u0438\u0440\u0438\u043D\u0430 \u0434\u043E:",value:(t==null?void 0:t.maxWidth)||0,type:T.TEXT,propertyType:B.INTEGER_POSITIVE_NUMBER},{caption:"\u0413\u043B\u0443\u0431\u0438\u043D\u0430 \u043E\u0442:",value:(t==null?void 0:t.minDepth)||0,type:T.TEXT,propertyType:B.INTEGER_POSITIVE_NUMBER},{caption:"\u0413\u043B\u0443\u0431\u0438\u043D\u0430 \u0434\u043E:",value:(t==null?void 0:t.maxDepth)||0,type:T.TEXT,propertyType:B.INTEGER_POSITIVE_NUMBER},{caption:"\u0412\u044B\u0441\u043E\u0442\u0430 \u043E\u0442:",value:(t==null?void 0:t.minHeight)||0,type:T.TEXT,propertyType:B.INTEGER_POSITIVE_NUMBER},{caption:"\u0412\u044B\u0441\u043E\u0442\u0430 \u0434\u043E:",value:(t==null?void 0:t.maxHeight)||0,type:T.TEXT,propertyType:B.INTEGER_POSITIVE_NUMBER},{caption:"\u041A\u043E\u043B-\u0432\u043E:",value:(t==null?void 0:t.count)||0,type:T.TEXT,propertyType:B.POSITIVE_NUMBER},{caption:"\u0420\u0430\u0437\u043C\u0435\u0440:",value:(t==null?void 0:t.size)||"",type:T.TEXT,optional:!0}];return h.exports.useEffect(()=>{o()},[]),h.exports.useEffect(()=>{N(R.length&&R.length-1)},[D]),h.exports.useEffect(()=>{N(0)},[l]),L(V,{children:[L("div",{children:[m(st,{value:l,displayValue:e=>p.get(e),items:[...p.keys()],onChange:e=>b(e)}),m(F,{heads:O,content:M,onSelectRow:e=>{N(e)}})]}),s!=null&&s.Read?m(z,{name:((u=y.get(t==null?void 0:t.specId))==null?void 0:u.name)||"",items:w,onUpdate:s!=null&&s.Update?async(e,i)=>{const a=e[0]?i[0]:t.specId,r=e[1]?+i[1]:t.minWidth,g=e[2]?+i[2]:t.maxWidth,f=e[3]?+i[3]:t.minDepth,_=e[4]?+i[4]:t.maxDepth,v=e[5]?+i[5]:t.minHeight,k=e[6]?+i[6]:t.maxHeight,X=e[7]?+i[7]:t.count,tt=e[8]?i[8]:t.size;return await c({id:t.id,wardrobeId:l,specId:a,maxWidth:g,minWidth:r,maxDepth:_,minDepth:f,minHeight:v,maxHeight:k,count:X,size:tt})}:void 0,onDelete:s!=null&&s.Delete?async()=>{const e=await E(t.id);return N(0),e}:void 0,onAdd:s!=null&&s.Create?async(e,i)=>{const a=e[0]?i[0]:t.specId,r=e[1]?+i[1]:t.minWidth,g=e[2]?+i[2]:t.maxWidth,f=e[3]?+i[3]:t.minDepth,_=e[4]?+i[4]:t.maxDepth,v=e[5]?+i[5]:t.minHeight,k=e[6]?+i[6]:t.maxHeight,X=e[7]?+i[7]:t.count,tt=e[8]?i[8]:t.size;return await n({wardrobeId:l,specId:a,maxWidth:g,minWidth:r,maxDepth:_,minDepth:f,minHeight:v,maxHeight:k,count:X,size:tt})}:void 0}):m("div",{})]})}const G=new Map;G.set(1,"\u041D\u043E\u043C\u0435\u043D\u043A\u043B\u0430\u0442\u0443\u0440\u0430");G.set(2,"\u0425\u0430\u0440\u0430\u043A\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043A\u0438");G.set(3,"\u0425\u0430\u0440\u0430\u043A\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043A\u0438 \u043D\u043E\u043C\u0435\u043D\u043A\u043B\u0430\u0442\u0443\u0440");G.set(4,"\u0414\u0421\u041F - \u041A\u0440\u043E\u043C\u043A\u0430 - \u0417\u0430\u0433\u043B\u0443\u0448\u043A\u0430");G.set(5,"\u0414\u0435\u0442\u0430\u043B\u0438\u0440\u043E\u0432\u043A\u0438");G.set(6,"\u0424\u0443\u0440\u043D\u0438\u0442\u0443\u0440\u0430");function Xt(){const d=St(),{permissions:s}=I(S),o=s.get(W.SPECIFICATION),[c,n]=h.exports.useState(1),E=[...G.entries()].map((y,l)=>m("div",{className:c===y[0]?"tab-button-active":"tab-button-inactive",onClick:()=>{n(y[0])},role:"button",children:y[1]},l)),p=Ht(c);return h.exports.useEffect(()=>{o!=null&&o.Read||d("/")},[o]),L("div",{className:"database-edit-container",children:[m("div",{className:"tab-header-container",children:E}),p]})}function Ht(d){const s=new Map;return s.set(1,m(Ct,{})),s.set(2,m(_t,{})),s.set(3,m(xt,{})),s.set(4,m(Bt,{})),s.set(5,m(Mt,{})),s.set(6,m(vt,{})),s.get(d)||m(ft,{})}export{Xt as default};
