import{c as e,u as C,a as p,L as g4,N as m4,R as u4,r as A,O as p4,j as E,Q as T,C as S,U as X,P as q,e as o4,V as f4,X as E4,i as a4,Y as Z,Z as v4,_ as C4,$ as x4,a0 as y4,a1 as F4,a2 as A4,a3 as b4,a4 as D4,a5 as w4,a6 as I4,a7 as T4,a8 as B4,a9 as s4,aa as W4,ab as k4,H as K,ac as P4,ad as H4,ae as k,af as r4,ag as c4,ah as S4,ai as N4,aj as R4,ak as M4,al as $4,am as z4,an as L4,ao as V4,ap as O4,aq as _4,ar as e4,as as G4,at as U4,au as j4,av as Y4,b as X4,aw as q4,ax as K4,ay as Q4,az as Z4,aA as J4}from"./index.47d4e2e6.js";import{P as l4}from"./PropertyGrid.066e1223.js";function Q(u){return e("div",{className:"property-row",children:u.children})}const uu=[2,3,4,5,6];function eu(){const u=C(o4),t=C(f4),n=C(E4),i=C(a4),{profile:m,fasadCount:c,type:h,wardHeight:a,wardWidth:f}=C(Z),v=p(v4),s=p(C4),x=p(x4),B=p(y4),I=p(F4),y=g4(),b=m4(),H=p(A4),N=p(b4),F=p(D4),{next:V,previous:R}=C(w4),D=p(I4),M=p(T4),w=u.permissions.get(u4.COMBIFASADES),$=!(w!=null&&w.Create),z=!(w!=null&&w.Read),U=A.exports.useMemo(()=>[...t.keys()].filter(r=>r!==p4.GARDEROB),[t]),O=async()=>(await b("\u0422\u0435\u043A\u0443\u0449\u0430\u044F \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F \u0444\u0430\u0441\u0430\u0434\u043E\u0432 \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u0430 \u043F\u0440\u0438 \u0434\u0430\u043D\u043D\u043E\u043C \u0442\u0438\u043F\u0435 \u0448\u043A\u0430\u0444\u0430"),!1),_=async()=>(await b("\u0422\u0435\u043A\u0443\u0449\u0430\u044F \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F \u0444\u0430\u0441\u0430\u0434\u043E\u0432 \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u0430 \u043F\u0440\u0438 \u0434\u0430\u043D\u043D\u043E\u0439 \u0432\u044B\u0441\u043E\u0442\u0435"),!1),o=async()=>(await b("\u0422\u0435\u043A\u0443\u0449\u0430\u044F \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F \u0444\u0430\u0441\u0430\u0434\u043E\u0432 \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u0430 \u043F\u0440\u0438 \u0434\u0430\u043D\u043D\u043E\u0439 \u0448\u0438\u0440\u0438\u043D\u0435"),!1),g=async()=>(await b("\u0422\u0435\u043A\u0443\u0449\u0430\u044F \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F \u0444\u0430\u0441\u0430\u0434\u043E\u0432 \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u0430 \u043F\u0440\u0438 \u0434\u0430\u043D\u043D\u043E\u043C \u0442\u0438\u043F\u0435 \u043F\u0440\u043E\u0444\u0438\u043B\u044F"),!1),d=async()=>(await b("\u0422\u0435\u043A\u0443\u0449\u0430\u044F \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F \u0444\u0430\u0441\u0430\u0434\u043E\u0432 \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u0430 \u043F\u0440\u0438 \u0434\u0430\u043D\u043D\u043E\u043C \u043A\u043E\u043B-\u0432\u0435 \u0444\u0430\u0441\u0430\u0434\u043E\u0432"),!1);return E("div",{className:"properties-bar",children:[E("div",{className:"d-flex flex-nowrap justify-content-between",children:[e("div",{children:"\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B \u0448\u043A\u0430\u0444\u0430"}),E("div",{className:"d-flex flex-nowrap  align-self-center gap-2 h-100",children:[e(T,{title:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438 \u043F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E",icon:"new",onClick:async()=>{await y("\u0421\u0431\u0440\u043E\u0441\u0438\u0442\u044C \u0432 \u043D\u0430\u0447\u0430\u043B\u044C\u043D\u043E\u0435 \u0441\u043E\u0441\u0442\u043E\u044F\u043D\u0438\u0435?")&&H()}}),e(T,{title:"\u041E\u0442\u043A\u0440\u044B\u0442\u044C",icon:"open",disabled:z,onClick:()=>{F()}}),e(T,{title:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",icon:"save",disabled:$,onClick:()=>{N()}}),e(T,{title:"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C",icon:"undo",disabled:!R,onClick:()=>{D()}}),e(T,{title:"\u041F\u043E\u0432\u0442\u043E\u0440\u0438\u0442\u044C",icon:"redo",disabled:!V,onClick:()=>{M()}})]})]}),e("hr",{}),E(l4,{children:[e(S,{title:"\u0422\u0438\u043F:",value:h,items:U,displayValue:r=>t.get(r)||"",onChange:r=>{I([r,O])}}),e("div",{className:"text-end",children:"\u0428\u0438\u0440\u0438\u043D\u0430: "}),e(Q,{children:e(X,{name:"width",value:f,type:q.INTEGER_POSITIVE_NUMBER,min:900,max:4e3,setValue:r=>{x([+r,o])},submitOnLostFocus:!0})}),e("div",{className:"text-end",children:"\u0412\u044B\u0441\u043E\u0442\u0430: "}),e(Q,{children:e(X,{name:"height",value:a,type:q.INTEGER_POSITIVE_NUMBER,min:1800,max:2700,setValue:r=>{B([+r,_])},submitOnLostFocus:!0})}),e(S,{title:"\u041A\u043E\u043B-\u0432\u043E \u0444\u0430\u0441\u0430\u0434\u043E\u0432:",value:c,items:uu,displayValue:r=>`${r}`,onChange:r=>{s([+r,d])}}),e(S,{title:"\u041F\u0440\u043E\u0444\u0438\u043B\u044C:",value:m.id,items:[...n.keys()],displayValue:r=>{var W,P;return((P=i.get(((W=n.get(r))==null?void 0:W.charId)||0))==null?void 0:P.name)||""},onChange:(r,W)=>{v([W,g])}})]})]})}function n4({title:u,onClick:t,iconPressed:n,iconUnPressed:i,pressed:m,disabled:c=!1,visible:h=!0}){let a=c?"button-disabled":"button";a+=m?" button-down":" button-up";const{onMouseOver:f,onMouseLeave:v}=B4(u);return e("div",{style:{visibility:h?"visible":"hidden"},className:`${a} ${m?n:i} noselect`,onClick:s=>{c||(s.stopPropagation(),t())},onMouseOver:s=>{f(s,{disabled:c})},onMouseLeave:()=>{v()},onContextMenu:s=>{s.preventDefault()}})}const tu=[1,2,3,4,5,6,7,8,9,10],Y=new Map;function iu(){const{permissions:u}=C(o4),t=u.get(u4.SPECIFICATION),n=u.get(u4.TEMPLATE),i=C(r4);C(Z);const m=i==null?void 0:i.parent;C(c4);const c=C(S4),h=C(N4),a=C(a4),{width:f,height:v,materialId:s,fasadType:x,direction:B,directions:I,sectionCount:y,fixHeight:b,fixWidth:H,disabledWidth:N,disabledHeight:F,disabledFixHeight:V,disabledFixWidth:R}=su(i),D=A.exports.useMemo(()=>{const l=h.filter(G=>G.id===x);return(x===s4.DSP||x===s4.LACOBEL?l.toSorted((G,h4)=>{var t4,i4;return(((t4=a.get(G.charId))==null?void 0:t4.name)||"")>(((i4=a.get(h4.charId))==null?void 0:i4.name)||"")?1:-1}):l).map(G=>G.charId)},[h,x]),M=i?tu:[],w=p(R4),$=p(M4),z=p($4),U=p(z4),O=p(L4),_=p(V4),o=p(O4),g=p(_4),d=p(e4),r=C(G4),W=p(U4),P=p(j4),L=W4(m),j=k4(m);return E("div",{className:"properties-bar",onClick:l=>{l.stopPropagation()},children:[E("div",{className:"property-bar-header",children:["\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B \u0444\u0430\u0441\u0430\u0434\u0430",E("div",{className:"d-flex gap-1",children:[(t==null?void 0:t.Read)&&e(K,{children:e(T,{title:"C\u043F\u0435\u0446\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u044F",icon:"specButton",onClick:()=>{P()}})}),(n==null?void 0:n.Create)&&e(T,{title:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u043A\u0430\u043A \u0448\u0430\u0431\u043B\u043E\u043D",icon:"save",visible:i!==null,onClick:()=>{W(!0)}}),(n==null?void 0:n.Read)&&e(T,{title:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0438\u0437 \u0448\u0430\u0431\u043B\u043E\u043D\u0430",icon:"open",visible:i!==null,onClick:()=>{W(!1)}}),i&&e(T,{title:"\u0421\u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0444\u0430\u0441\u0430\u0434",icon:"copy",onClick:()=>{var l;(l=r==null?void 0:r.current)==null||l.showModal()}}),e(T,{title:"\u041F\u0435\u0440\u0435\u0439\u0442\u0438 \u043D\u0430 \u0443\u0440\u043E\u0432\u0435\u043D\u044C \u0432\u0432\u0435\u0440\u0445",icon:"selectParent",onClick:()=>{d(m)},disabled:i===null||(i==null?void 0:i.level)===0})]})]}),e("hr",{}),E(l4,{children:[e("div",{className:"text-end",children:"\u0412\u044B\u0441\u043E\u0442\u0430: "}),E(Q,{children:[e(X,{value:v,type:q.INTEGER_POSITIVE_NUMBER,min:1,setValue:l=>{w(+l)},disabled:F}),j>0&&!b&&e("span",{children:`${i==null?void 0:i.heightRatio}/${j}`}),e(n4,{pressed:b,iconPressed:"fix",iconUnPressed:"unfix",title:"\u0417\u0430\u0444\u0438\u043A\u0441\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0432\u044B\u0441\u043E\u0442\u0443",visible:!V,onClick:()=>{U(!b)}})]}),e("div",{className:"text-end",children:"\u0428\u0438\u0440\u0438\u043D\u0430: "}),E(Q,{children:[e(X,{value:f,type:q.INTEGER_POSITIVE_NUMBER,min:1,setValue:l=>{$(+l)},disabled:N}),L>0&&!H&&e("span",{children:`${i==null?void 0:i.widthRatio}/${L}`}),e(n4,{pressed:H,iconPressed:"fix",iconUnPressed:"unfix",title:"\u0417\u0430\u0444\u0438\u043A\u0441\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0448\u0438\u0440\u0438\u043D\u0443",visible:!R,onClick:()=>{z(!H)}})]}),e(S,{title:"\u0422\u0438\u043F:",value:x,items:[...c.keys()],displayValue:l=>c.get(l),disabled:!i,onChange:l=>{O(l)}}),e(S,{title:"\u0426\u0432\u0435\u0442/\u0420\u0438\u0441\u0443\u043D\u043E\u043A:",value:s,items:D,displayValue:l=>{var J;return(J=a.get(l))==null?void 0:J.name},disabled:!i,onChange:l=>{_(l)}}),e(S,{title:"\u041D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u043F\u0440\u043E\u0444\u0438\u043B\u044F:",value:B,items:[...I.keys()],displayValue:l=>I.get(l),disabled:!i,onChange:l=>{o(l)}}),e(S,{title:"\u041A\u043E\u043B-\u0432\u043E \u0441\u0435\u043A\u0446\u0438\u0439:",value:y,items:M,displayValue:l=>`${l}`,disabled:!i,onChange:l=>{g(l)}})]})]})}function su(u,t){const n=P4(u),i=H4(u),m=(u==null?void 0:u.materialId)||0,c=(u==null?void 0:u.fasadType)||0;Y.clear(),u&&(Y.set(k.WIDTH,"\u0412\u0435\u0440\u0442\u0438\u043A\u0430\u043B\u044C\u043D\u043E"),Y.set(k.HEIGHT,"\u0413\u043E\u0440\u0438\u0437\u043E\u043D\u0442\u0430\u043B\u044C\u043D\u043E"));const h=u==null?void 0:u.division,a=u&&u.children.length>1?u.children.length:1,f=(u==null?void 0:u.fixedWidth)||!1,v=(u==null?void 0:u.fixedHeight)||!1,s=u==null?void 0:u.parent;let x=!u||u.level===0||u.level===1&&(s==null?void 0:s.division)===k.HEIGHT||u.fixedWidth,B=!u||u.level===0||u.level===1&&(s==null?void 0:s.division)===k.WIDTH||u.fixedHeight;const I=!u||u.level===0||u.level===1&&(s==null?void 0:s.division)===k.HEIGHT,y=!u||u.level===0||u.level===1&&(s==null?void 0:s.division)===k.WIDTH;return x=x||!!(u&&u.level<=1&&(s==null?void 0:s.division)===k.HEIGHT),B=B||!!(u&&u.level<=1&&(s==null?void 0:s.division)===k.WIDTH),{width:n,height:i,materialId:m,fasadType:c,direction:h,directions:Y,sectionCount:a,fixHeight:v,fixWidth:f,disabledWidth:x,disabledHeight:B,disabledFixHeight:y,disabledFixWidth:I}}function nu(){return e("div",{className:"fixedHeight"})}function ou(){return e("div",{className:"fixedWidth"})}function au(){return e("div",{className:"fixedBoth"})}function d4(u){const t=u.fasad,n=Y4(t),i=t.children.length===0,m=u.activeFasad,c=t.backImageProps;n||(c.top=0,c.left=0,c.size="");const[{top:h,left:a,size:f,repeat:v,drag:s,x0:x,y0:B,hasImage:I},y]=A.exports.useState({hasImage:!1,...c,drag:!1,x0:0,y0:0});A.exports.useMemo(()=>{y(o=>({...o,...c}))},[t,c.top,c.left,c.size,c.repeat]);const{showFixIcons:b}=C(c4),H=p(e4),N=X4(t.materialId),F=A.exports.useRef(null),V=A.exports.useRef(null);let R={gridTemplateRows:"1fr",gridTemplateColumns:"1fr"};if(!i){const o=t.division===k.HEIGHT,g=o?t.height:t.width,d=t.children.map(r=>`${(o?(r.height+1)/g:(r.width+1)/g).toFixed(3)}fr`).join(" ");R=o?{gridTemplateRows:d,gridTemplateColumns:"1fr"}:{gridTemplateRows:"1fr",gridTemplateColumns:d}}let D=t.level===0?{height:"100%"}:{};D={...D,boxShadow:t===m?"inset 0px 0px 10px red":""};let M={},w="";i?(D={...D,display:"flex",overflow:"hidden",flexShrink:"0",justifyContent:"center",alignItems:"center",objectFit:"cover",cursor:"pointer",border:"1px solid black",backgroundPosition:`top ${h}px left ${a}px`,backgroundSize:typeof f=="number"?`${f}%`:f,backgroundRepeat:v?"repeat":"no-repeat"},M={onClick:o=>{o.stopPropagation(),H(t)},onMouseDown:o=>{if(!!n){if(o.button===1){const g=q4();y(d=>({...d,...g})),t.backImageProps={...g};return}o.button===0&&(!o.shiftKey||!I||y(g=>({...g,drag:!0,x0:o.clientX,y0:o.clientY})))}},onMouseMove:o=>{if(o.button!==0||!s)return;const g=o.clientX-x,d=o.clientY-B;y(r=>({...r,top:r.top+d,left:r.left+g,x0:o.clientX,y0:o.clientY}))},onMouseUp:o=>{if(!!n){if(o.button!==0)return!0;y(g=>({...g,drag:!1})),t.backImageProps={top:h,left:a,size:f,repeat:v}}},onMouseLeave:()=>{!n||(y(o=>({...o,drag:!1})),t.backImageProps={top:h,left:a,size:f,repeat:v})}},w="fasad-section"):D={...D,border:t===m?"1px solid red":"",backgroundColor:"white",backgroundImage:""};const $=t.children.length===0&&t.fixedHeight&&b,z=t.children.length===0&&t.fixedWidth&&b,O=$&&z?e(au,{}):$?e(nu,{}):z?e(ou,{}):e(K,{}),_=t.children.length>1?t.children.map((o,g)=>e(d4,{fasad:o,activeFasad:u.activeFasad,rootFasad:u.rootFasad},g)):"";return A.exports.useEffect(()=>{const o=new Image,g=N;o.src=g,F.current&&(F.current.style.backgroundImage=g||getComputedStyle(F.current).getPropertyValue("--default-image"),F.current.style.backgroundPosition="top 0px left 0px",F.current.style.backgroundSize="",y(d=>({...d,hasImage:!1}))),F.current&&i&&g&&(F.current.style.backgroundImage=`url(${g})`,ru(F.current,{top:h,left:a,size:f,repeat:v}),y(d=>({...d,hasImage:!0})))},[N,i]),A.exports.useEffect(()=>{var g;if(!n)return;const o=d=>{if(d.preventDefault(),!I)return;const r=d.clientX-d.target.offsetLeft-a,W=d.clientY-d.target.offsetTop-h,P=Math.sign(d.deltaY)>=0?d.shiftKey?.99:.9:d.shiftKey?1.01:1.1;y(L=>{const j=typeof L.size=="string"?100:L.size;return{...L,size:j*P,top:h+W*(1-P),left:a+r*(1-P)}}),t.backImageProps={top:h,left:a,size:f,repeat:v}};return(g=F.current)==null||g.addEventListener("wheel",o,{passive:!1}),()=>{var d;(d=F.current)==null||d.removeEventListener("wheel",o)}},[I,a,h,n]),E("div",{ref:i?F:V,className:w,style:{display:"grid",...R,gap:"1px",...D},...M,children:[_,O]})}function ru(u,t){u.style.backgroundPosition=`top ${t.top}px left ${t.left}px`,u.style.backgroundSize=typeof t.size=="number"?`${t.size}%`:t.size,u.style.backgroundRepeat=t.repeat?"repeat":"no-repeat"}function cu({index:u}){const{rootFasades:t}=C(Z),n=C(K4),i=window.innerWidth,m=t[u],c=m.width/m.height;`${m.width}${m.height}`;const h=C(r4),a=A.exports.useRef(null),f=n===u?"fw-bold":"",v=s=>{a.current&&(a.current.style.width=a.current.offsetHeight*s+"px")};return A.exports.useLayoutEffect(()=>{v(c)},[c,i]),E("div",{className:"fasad-container",children:[e("div",{className:`text-center ${f}`,children:`\u0424\u0430\u0441\u0430\u0434 ${u+1}`}),e("div",{ref:a,className:"fasad-section-container",style:{height:"100%",width:"auto"},children:e(d4,{fasad:m,activeFasad:h,rootFasad:m})})]})}function lu(){const[,u]=A.exports.useState(0),[{rootFasades:t}]=Q4(Z),n=t[0].width/t[0].height,i=A.exports.useRef(null),m=t.map((h,a)=>e(cu,{index:a},a)),c=window.innerWidth;return A.exports.useEffect(()=>{const h=()=>u(Math.random());return window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}},[]),A.exports.useLayoutEffect(()=>{du(n,t,i)},[c,n,t]),e("div",{ref:i,className:"rootfasades-container",children:m})}const du=(u,t,n)=>{if(!n.current)return;const i=document.querySelector(".properties-container"),m=document.querySelector(".combifasades-container"),c=Z4(),h=parseFloat(getComputedStyle(n.current).gap);if(c){const a=i.offsetHeight,f=m.offsetWidth-i.offsetWidth,v=a*u,s=Math.min(Math.floor(f/(v+h)),t.length),x=v*s;n.current.style.height=`${a}px`,n.current.style.width=`${x}px`,n.current.style.overflowX=s<t.length?"scroll":"unset"}else{const a=Math.ceil(t.length/2),f=parseFloat(getComputedStyle(i).width),s=f/a/u;n.current.style.width=`${f}px`,n.current.style.height=`${s}px`,n.current.style.overflowX=a<t.length?"scroll":"unset"}};function hu(){return E("div",{className:"status-bar",children:[E("span",{children:[e("code",{children:"Shift + \u041B\u0435\u0432\u0430\u044F \u043A\u043D\u043E\u043F\u043A\u0430 \u043C\u044B\u0448\u0438"})," - \u0434\u0432\u0438\u0433\u0430\u0442\u044C \u043A\u0430\u0440\u0442\u0438\u043D\u043A\u0443 \u0444\u0430\u0441\u0430\u0434\u0430"]}),E("span",{children:[e("code",{children:"\u041A\u043E\u043B\u0435\u0441\u0438\u043A\u043E \u043C\u044B\u0448\u0438"})," - \u043C\u0430\u0441\u0448\u0442\u0430\u0431 +/-"]}),E("span",{children:[e("code",{children:"\u041A\u043E\u043B\u0435\u0441\u0438\u043A\u043E \u043C\u044B\u0448\u0438 + Shift"})," - \u043F\u043B\u0430\u0432\u043D\u044B\u0439 \u043C\u0430\u0441\u0448\u0442\u0430\u0431"]}),E("span",{children:[e("code",{children:"\u0421\u0440\u0435\u0434\u043D\u044F\u044F \u043A\u043D\u043E\u043F\u043A\u0430 \u043C\u044B\u0448\u0438"})," - \u0441\u0431\u0440\u043E\u0441 \u043C\u0430\u0441\u0448\u0442\u0430\u0431\u0430"]})]})}function pu(){const u=p(e4);return e(K,{children:E("div",{className:"main-container",children:[J4()?e(K,{}):e(hu,{}),E("div",{className:"combifasades-container",onClick:()=>{u()},children:[E("div",{className:"properties-container",children:[e(eu,{}),e(iu,{})]}),e(lu,{})]})]})})}export{pu as default};
